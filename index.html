<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Jungian Psyche Mandala</title>

<style>
/* ---------- root scale: 90 vmin / 1100 (base px) ---------- */
:root{
  --scale: calc(90vmin / 1100);        /* 90 % of the shorter side */
}

/* ---------- page centre ---------- */
html,body{
  height:100%;margin:0;
  display:flex;justify-content:center;align-items:center;
  background:#111;color:#fff;font-family:system-ui,sans-serif;
  user-select:none;touch-action:none;          /* prevent 2-finger zoom while dragging */
}

/* ---------- mandala container ---------- */
.psychic-model{
  position:relative;
  width:calc(1100px * var(--scale));
  height:calc(1100px * var(--scale));
}
.node{
  font-family: jetbrains-mono, monospace;
  font-weight: 900;
}

/* ---------- generic node ---------- */
.node{
  --diameter: calc(var(--size) * var(--scale));
  --radiusPx: calc(var(--rBase) * var(--scale));

  position:absolute;top:50%;left:50%;
  transform:
    translate(-50%,-50%)
    rotate(var(--angle))
    translate(var(--radiusPx))
    rotate(calc(-1*var(--angle)));
  width:var(--diameter);height:var(--diameter);
  border-radius:50%;display:flex;justify-content:center;align-items:center;
  text-align:center;font-size:calc(16px * var(--scale) + 0.4vmin);
  cursor:grab;
  transition:transform 0.4s ease;
}
.node:active{cursor:grabbing}
.node{
  padding: 10px;
}
/* ---------- outline ring ---------- */
.ring{
  position:absolute;top:50%;left:50%;
  width:100%;height:100%;
  transform:translate(-50%,-50%);
  border:calc(2px * var(--scale)) solid #fff;
  border-radius:50%;pointer-events:none;
}
@media (max-width: 768px) {
  :root {
    --scale: calc(98vw / 1100);
  }
  .psychic-model {
    width: 98vw;
    height: 98vw;
  }
  .node {
    font-size: calc(12px * var(--scale) + 0.8vmin);
    padding: 6px;
  }
}
@media (max-width: 480px) {
  :root {
    --scale: calc(98vw / 1100);
  }
  .psychic-model {
    width: 98vw;
    height: 98vw;
  }
  .node {
    font-size: calc(10px * var(--scale) + 1vmin);
    padding: 4px;
  }
}
</style>
</head>
<body>

<div class="psychic-model">

  <!-- baseâ€radius(px),   size(px),  angle -->
  <div class="node" style="--rBase:0;   --size:200; --angle:0deg;    background:lightblue;">Self</div>
  <div class="node" style="--rBase:175; --size:80;  --angle:0deg;  z-index: 12;  background:antiquewhite;">Persona</div>
  <div class="node" style="--rBase:100; --size:100; --angle:0deg;    background:#f39c12;">Ego</div>
  <div class="node" style="--rBase:190; --size:100; --angle:210deg;  background:#2c3e50; z-index: 12;">Shadow</div>
  <div class="node" style="--rBase:190; --size:100; --angle:-210deg;  background:#e74c3c; z-index: 12;">Anima / Animus</div>
  <div class="node" style="--rBase:130; --size:150; --angle:180deg; background:#8e44ad; z-index: 1;">Personal<br>Unconscious</div>
  <div class="node" style="--rBase:280; --size:200; --angle:180deg; background:#3498db;">Collective<br>Unconscious</div>

  <div class="ring"></div>
</div>

<script>
document.querySelectorAll('.node').forEach(node => {
  let startX, startY, originTransform, dragging = false;

  /* ---------- pointer down ---------- */
  node.addEventListener('pointerdown', e => {
    e.preventDefault();                                // stop scrolling on mobile
    node.setPointerCapture(e.pointerId);

    originTransform =
      window.getComputedStyle(node).transform === 'none'
        ? ''                                           // unlikely, but safe-guard
        : window.getComputedStyle(node).transform;

    startX   = e.clientX;
    startY   = e.clientY;
    dragging = true;
    node.style.transition = 'none';                    // free movement
  });

  /* ---------- pointer move ---------- */
  node.addEventListener('pointermove', e => {
    if (!dragging || !node.hasPointerCapture(e.pointerId)) return;
    const dx = e.clientX - startX;
    const dy = e.clientY - startY;

    /* keep the polar layout, add a *relative* offset */
    node.style.transform = `${originTransform} translate(${dx}px, ${dy}px)`;
  });

  /* ---------- pointer up ---------- */
  node.addEventListener('pointerup', e => {
    if (!dragging) return;
    dragging = false;
    node.releasePointerCapture(e.pointerId);

    /* snap back to the exact polar transform we cached */
    node.style.transition = 'transform 0.6s cubic-bezier(.17,.67,.43,1.31)';
    node.style.transform  = originTransform;

    /* after the snap-back animation, clear inline styles so
       future viewport resizes recalculate correctly        */
    node.addEventListener('transitionend', () => {
      node.style.transition = '';
      node.style.transform  = '';
    }, { once: true });
  });
});
</script>


</body>
</html>
